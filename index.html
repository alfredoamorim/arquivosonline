<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atualização de Planilha</title>
</head>
<body>
    <h1>Dados da Planilha</h1>
    <table border="1">
        <thead>
            <tr id="cabecalho"></tr>
        </thead>
        <tbody id="dados"></tbody>
    </table>
    
    <button onclick="atualizarConteudo()">Atualizar Dados</button>

    <script>
        async function atualizarConteudo() {
            try {
                let url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSBaMmjtdXueRfXxmhgcKIKMyOIgAsP0JOraxxlcoLZXJX-EpdFKw_vzhEgbZVOict6gdnaDT1twJjR/pub?output=csv";
                let resposta = await fetch(url);
                let texto = await resposta.text();
                
                let linhas = texto.split("\n").map(l => l.split(","));
                let cabecalho = linhas[0];
                let conteudo = linhas.slice(1);

                // Atualiza o cabeçalho da tabela
                document.getElementById("cabecalho").innerHTML = cabecalho.map(h => `<th>${h}</th>`).join("");

                // Atualiza o corpo da tabela
                document.getElementById("dados").innerHTML = conteudo.map(linha => 
                    `<tr>${linha.map(cel => `<td>${cel}</td>`).join("")}</tr>`).join("");
                
            } catch (error) {
                console.error("Erro ao buscar dados:", error);
            }
        }

        // Atualiza a cada 10 segundos automaticamente
        setInterval(atualizarConteudo, 10000);

        // Atualiza ao carregar a página
        atualizarConteudo();
    </script>
</body>
</html>
